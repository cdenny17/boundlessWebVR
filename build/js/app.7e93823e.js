!function(n){function e(e){for(var r,i,u=e[0],s=e[1],c=e[2],l=0,d=[];l<u.length;l++)i=u[l],o[i]&&d.push(o[i][0]),o[i]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(n[r]=s[r]);for(p&&p(e);d.length;)d.shift()();return a.push.apply(a,c||[]),t()}function t(){for(var n,e=0;e<a.length;e++){for(var t=a[e],r=!0,u=1;u<t.length;u++){var s=t[u];0!==o[s]&&(r=!1)}r&&(a.splice(e--,1),n=i(i.s=t[0]))}return n}var r={},o={0:0},a=[];function i(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,i),t.l=!0,t.exports}i.m=n,i.c=r,i.d=function(n,e,t){i.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},i.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},i.t=function(n,e){if(1&e&&(n=i(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(i.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)i.d(t,r,function(e){return n[e]}.bind(null,r));return t},i.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return i.d(e,"a",e),e},i.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},i.p="";var u=window.webpackJsonp=window.webpackJsonp||[],s=u.push.bind(u);u.push=e,u=u.slice();for(var c=0;c<u.length;c++)e(u[c]);var p=s;a.push([98,1]),t()}({50:function(n,e,t){n.exports=t.p+"src/objects/bow9.gltf"},52:function(n,e,t){n.exports=t.p+"src/image/target.png"},53:function(n,e,t){n.exports=t.p+"src/image/depot.png"},54:function(n,e,t){n.exports=t.p+"src/image/albedo.png"},55:function(n,e,t){n.exports=t.p+"src/image/bump.png"},56:function(n,e,t){n.exports=t.p+"src/image/rough.png"},70:function(n,e,t){},71:function(n,e,t){"use strict";t.r(e),t.d(e,"checkForXRSupport",function(){return b}),t.d(e,"setLeftHand",function(){return z}),t.d(e,"setRightHand",function(){return F}),t.d(e,"getRightHandPostion",function(){return L}),t.d(e,"getLeftHandPostion",function(){return A}),t.d(e,"start",function(){return j}),t.d(e,"addButtonPressListener",function(){return E}),t.d(e,"addButtonReleaseListener",function(){return k}),t.d(e,"setUpdate",function(){return O});t(72),t(78),t(79),t(46),t(85),t(88),t(90);var r=t(0),o=null,a=null,i=null,u=null,s=null,c=null,p=[],l=[],d=function(){},f=null,g=null,m=[],h=[],w=null,v=null;function b(){return navigator.xr.supportsSession("immersive-vr")}function y(n){(f=n).requestReferenceSpace("local").then(function(n){g=n}).then(x).then(function(){f.requestAnimationFrame(M)})}function x(){return o.makeXRCompatible().then(function(){f.updateRenderState({baseLayer:new XRWebGLLayer(f,o)})})}function M(n,e){if(f){var t=f.renderState.baseLayer,r=e.getViewerPose(g);if(r){a.matrixAutoUpdate=!1,s&&(s.matrixAutoUpdate=!1),c&&(c.matrixAutoUpdate=!1),u.autoClear=!1,u.clear(),u.setSize(t.framebufferWidth,t.framebufferHeight,!1),o.bindFramebuffer(o.FRAMEBUFFER,t.framebuffer);var i=!0,p=!1,l=void 0;try{for(var m,h=r.views[Symbol.iterator]();!(i=(m=h.next()).done);i=!0){var w=m.value,v=t.getViewport(w);P(w.transform.inverse.matrix,w.projectionMatrix,v)}}catch(n){p=!0,l=n}finally{try{i||null==h.return||h.return()}finally{if(p)throw l}}var b=f.inputSources,y=!0,x=!1,z=void 0;try{for(var F,L=b[Symbol.iterator]();!(y=(F=L.next()).done);y=!0){var A=F.value,j=e.getPose(A.gripSpace,g);if(j&&("left"===A.handedness&&H(j.transform),"right"===A.handedness&&B(j.transform),A.gamepad&&A.gamepad.buttons.length>0)){A.gamepad.buttons.length;"left"===A.handedness&&S(A.gamepad.buttons),"right"===A.handedness&&R(A.gamepad.buttons)}}}catch(n){x=!0,z=n}finally{try{y||null==L.return||L.return()}finally{if(x)throw z}}}d(),f.requestAnimationFrame(M)}else window.requestAnimationFrame(M)}function S(n){for(var e=n.length,t=[],r=[],o=0;o<e;++o)n[o].pressed?t.push(o):r.push(o);for(var a=0;a<t.length;++a)m[t[a]]||(W("left",t[a]),m[t[a]]=!0);for(var i=0;i<r.length;++i)m[r[i]]&&(q("left",r[i]),m[r[i]]=!1)}function R(n){for(var e=n.length,t=[],r=[],o=0;o<e;++o)n[o].pressed?t.push(o):r.push(o);for(var a=0;a<t.length;++a)h[t[a]]||(W("right",t[a]),h[t[a]]=!0);for(var i=0;i<r.length;++i)h[r[i]]&&(q("right",r[i]),h[r[i]]=!1)}function H(n){if(s){var e=new r.E;e.fromArray(n.matrix),v=n.position,s.matrix.copy(e)}}function B(n){if(c){var e=new r.E;e.fromArray(n.matrix),w=n.position,c.matrix.copy(e)}}function P(n,e,t){u.setViewport(t.x,t.y,t.width,t.height);var o=new r.E;o.fromArray(n,0),i.projectionMatrix.fromArray(e),i.matrixWorldInverse.copy(o),a.matrix.copy(o),a.updateMatrixWorld(!0),u.render(a,i),u.clearDepth()}function z(n){s=n}function F(n){c=n}function L(){return w}function A(){return v}function j(n,e,t,r){n&&e&&t&&r?(a=e,i=t,u=r,o=n.getContext("webgl",{xrCompatible:!0}),navigator.xr.requestSession("immersive-vr").then(y).catch(function(n){window.requestAnimationFrame(M)})):console.error("Missing required parameter")}function E(n,e,t){p.push({hand:n,num:e,func:t})}function k(n,e,t){l.push({hand:n,num:e,func:t})}function O(n){d=n}function W(n,e){for(var t=p,r=0;r<t.length;r++){var o=t[r];o.hand===n&&o.num===e&&o.func()}}function q(n,e){for(var t=l,r=0;r<t.length;r++){var o=t[r];o.hand===n&&o.num===e&&o.func()}}},92:function(n,e,t){n.exports=t.p+"src/image/cubemap/px.png"},93:function(n,e,t){n.exports=t.p+"src/image/cubemap/nx.png"},94:function(n,e,t){n.exports=t.p+"src/image/cubemap/py.png"},95:function(n,e,t){n.exports=t.p+"src/image/cubemap/ny.png"},96:function(n,e,t){n.exports=t.p+"src/image/cubemap/pz.png"},97:function(n,e,t){n.exports=t.p+"src/image/cubemap/nz.png"},98:function(n,e,t){"use strict";t.r(e);t(57),t(68),t(70);var r=t(0),o=t(71),a=t(50),i=t.n(a),u=t(51),s=t(52),c=t.n(s),p=(t(92),t(93),t(94),t(95),t(96),t(97),t(53)),l=t.n(p),d=t(54),f=t.n(d),g=t(55),m=t.n(g),h=t(56),w=t.n(h);function v(n){return n*(Math.PI/180)}var b=document.createElement("canvas"),y=new r.ab,x=new r.Q(75,window.innerWidth/window.innerHeight,.1,1e3),M=new r.pb({canvas:b}),S=new r.j(16777215,1),R=new r.a(11184810),H=(new r.hb).load(l.a),B=new r.F(new r.h(.3,.3,.3),new r.H({color:new r.g(16777215)})),P=new r.F(new r.fb(50,50,50),new r.G({map:H,side:r.k})),z=(new r.hb).load(c.a),F=(new r.hb).load(f.a),L=(new r.hb).load(m.a),A=(new r.hb).load(w.a),j=new r.I({map:F,normalMap:L,roughnessMap:A,metalness:.5,roughness:1,normalScale:new r.lb(3,3)});j.map.wrapS=r.Z,j.map.wrapT=r.Z,j.map.repeat.set(4,2),j.normalMap.wrapS=r.Z,j.normalMap.wrapT=r.Z,j.normalMap.repeat.set(2,2),j.roughnessMap.wrapS=r.Z,j.roughnessMap.wrapT=r.Z,j.roughnessMap.repeat.set(4,2);document.getElementById("targ");var E=new r.F(new r.h(.5,.5,.5),new r.G({color:new r.g(16777215),map:z})),k=new r.F(new r.R(10,10,10,10),j);k.position.y=-1.5,k.position.z=0,k.rotateX(v(-90)),B.position.y=0,B.position.z=-3,E.position.y=0,E.position.z=-3;var O,W=0,q=null,X=null,T=!1,U=null;y.add(B),y.add(E),y.add(k),y.add(S),y.add(R),y.add(P),(new u.a).load(i.a,function(n){console.log(n),(O=n.scene.children[1]).material=new r.H({color:new r.g(12303291)}),O.material.side=r.k,O.traverse(function(n){n.material=new r.H({color:new r.g(6175774),skinning:!0})}),O.rotateX(v(90)),O.scale.x=.5,O.scale.y=.5,O.scale.z=.5,Z=O.children[1].children[0].skeleton.bones[17],(q=new r.n).add(O),y.add(q),o.setLeftHand(q);var e=n.scene.children[1];e.material=new r.H({color:new r.g(6175774)});e.scale.y=.1,e.scale.z=.1,e.scale.x=.1,e.rotateX(v(180)),e.position.z=-.25,(U=e.clone()).rotateX(v(-90)),U.position.y-=.23,U.position.z+=.25,U.position.y,(X=new r.n).add(e),y.add(X),o.setRightHand(X)},function(n){console.log("".concat(n.loaded/n.total*100,"% loaded"))},function(n){console.error("An error happened",n)});var Z=null;o.addButtonPressListener("right",0,function(){console.log("right handle buttons squeezed"),T=!0}),o.addButtonReleaseListener("right",0,function(){T=!1,o.setRightHand(null),X.children[0].speed=W/2,Z.position.y=-1.4162278175354004;var n=X.clone();y.add(n),X=n,o.setRightHand(X)}),o.setUpdate(function(){var n=o.getLeftHandPostion(),e=o.getRightHandPostion();if(n&&e){var t=new r.mb(n.x,n.y,n.z),a=new r.mb(e.x,e.y,e.z);W=t.distanceTo(a),Z&&T&&(Z.position.y=Math.min(-12*W,-1.4162278175354004))}B.geometry.computeBoundingBox();var i=B.geometry.boundingBox.clone();B.updateMatrixWorld(!0),i.copy(B.geometry.boundingBox).applyMatrix4(B.matrixWorld),y.traverse(function(n){if(n.speed){n.position.z-=n.speed,n.geometry.computeBoundingBox();var e=n.geometry.boundingBox.clone();n.updateMatrixWorld(!0),e.copy(n.geometry.boundingBox).applyMatrix4(n.matrixWorld),e.intersectsBox(i)&&(console.log("intersection"),n.speed=0)}})}),o.checkForXRSupport().then(function(n){var e=document.createElement("button");e.innerHTML="Enter VR",e.addEventListener("click",function(){o.start(b,y,x,M)}),document.getElementById("header").appendChild(e)}).catch(function(n){console.error(n)})}});
//# sourceMappingURL=app.7e93823e.js.map