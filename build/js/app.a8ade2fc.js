!function(n){function e(e){for(var r,a,u=e[0],l=e[1],s=e[2],d=0,f=[];d<u.length;d++)a=u[d],o[a]&&f.push(o[a][0]),o[a]=0;for(r in l)Object.prototype.hasOwnProperty.call(l,r)&&(n[r]=l[r]);for(c&&c(e);f.length;)f.shift()();return i.push.apply(i,s||[]),t()}function t(){for(var n,e=0;e<i.length;e++){for(var t=i[e],r=!0,u=1;u<t.length;u++){var l=t[u];0!==o[l]&&(r=!1)}r&&(i.splice(e--,1),n=a(a.s=t[0]))}return n}var r={},o={0:0},i=[];function a(e){if(r[e])return r[e].exports;var t=r[e]={i:e,l:!1,exports:{}};return n[e].call(t.exports,t,t.exports,a),t.l=!0,t.exports}a.m=n,a.c=r,a.d=function(n,e,t){a.o(n,e)||Object.defineProperty(n,e,{enumerable:!0,get:t})},a.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},a.t=function(n,e){if(1&e&&(n=a(n)),8&e)return n;if(4&e&&"object"==typeof n&&n&&n.__esModule)return n;var t=Object.create(null);if(a.r(t),Object.defineProperty(t,"default",{enumerable:!0,value:n}),2&e&&"string"!=typeof n)for(var r in n)a.d(t,r,function(e){return n[e]}.bind(null,r));return t},a.n=function(n){var e=n&&n.__esModule?function(){return n.default}:function(){return n};return a.d(e,"a",e),e},a.o=function(n,e){return Object.prototype.hasOwnProperty.call(n,e)},a.p="";var u=window.webpackJsonp=window.webpackJsonp||[],l=u.push.bind(u);u.push=e,u=u.slice();for(var s=0;s<u.length;s++)e(u[s]);var c=l;i.push([81,1]),t()}({46:function(n,e,t){n.exports=t.p+"src/objects/bow9.gltf"},48:function(n,e,t){n.exports=t.p+"src/image/target2.png"},49:function(n,e,t){n.exports=t.p+"src/image/whiteBG.jpeg"},50:function(n,e,t){},51:function(n,e,t){"use strict";t.r(e),t.d(e,"checkForXRSupport",function(){return y}),t.d(e,"setLeftHand",function(){return P}),t.d(e,"setRightHand",function(){return j}),t.d(e,"getRightHandPostion",function(){return A}),t.d(e,"getLeftHandPostion",function(){return L}),t.d(e,"start",function(){return z}),t.d(e,"addButtonPressListener",function(){return k}),t.d(e,"addButtonReleaseListener",function(){return q}),t.d(e,"setUpdate",function(){return O});t(52),t(66),t(67),t(42),t(74),t(77),t(79);var r=t(0),o=null,i=null,a=null,u=null,l=null,s=null,c=[],d=[],f=function(){},p=null,h=null,g=[],m=[],v=null,w=null;function y(){return navigator.xr.supportsSession("immersive-vr")}function b(n){(p=n).requestReferenceSpace("local").then(function(n){h=n}).then(x).then(function(){p.requestAnimationFrame(H)})}function x(){return o.makeXRCompatible().then(function(){p.updateRenderState({baseLayer:new XRWebGLLayer(p,o)})})}function H(n,e){if(p){var t=p.renderState.baseLayer,r=e.getViewerPose(h);if(r){i.matrixAutoUpdate=!1,l&&(l.matrixAutoUpdate=!1),s&&(s.matrixAutoUpdate=!1),u.autoClear=!1,u.clear(),u.setSize(t.framebufferWidth,t.framebufferHeight,!1),o.bindFramebuffer(o.FRAMEBUFFER,t.framebuffer);var a=!0,c=!1,d=void 0;try{for(var g,m=r.views[Symbol.iterator]();!(a=(g=m.next()).done);a=!0){var v=g.value,w=t.getViewport(v);M(v.transform.inverse.matrix,v.projectionMatrix,w)}}catch(n){c=!0,d=n}finally{try{a||null==m.return||m.return()}finally{if(c)throw d}}var y=p.inputSources,b=!0,x=!1,P=void 0;try{for(var j,A=y[Symbol.iterator]();!(b=(j=A.next()).done);b=!0){var L=j.value,z=e.getPose(L.gripSpace,h);if(z&&("left"===L.handedness&&B(z.transform),"right"===L.handedness&&F(z.transform),L.gamepad&&L.gamepad.buttons.length>0)){L.gamepad.buttons.length;"left"===L.handedness&&R(L.gamepad.buttons),"right"===L.handedness&&S(L.gamepad.buttons)}}}catch(n){x=!0,P=n}finally{try{b||null==A.return||A.return()}finally{if(x)throw P}}}f(),p.requestAnimationFrame(H)}else window.requestAnimationFrame(H)}function R(n){for(var e=n.length,t=[],r=[],o=0;o<e;++o)n[o].pressed?t.push(o):r.push(o);for(var i=0;i<t.length;++i)g[t[i]]||(W("left",t[i]),g[t[i]]=!0);for(var a=0;a<r.length;++a)g[r[a]]&&(E("left",r[a]),g[r[a]]=!1)}function S(n){for(var e=n.length,t=[],r=[],o=0;o<e;++o)n[o].pressed?t.push(o):r.push(o);for(var i=0;i<t.length;++i)m[t[i]]||(W("right",t[i]),m[t[i]]=!0);for(var a=0;a<r.length;++a)m[r[a]]&&(E("right",r[a]),m[r[a]]=!1)}function B(n){if(l){var e=new r.E;e.fromArray(n.matrix),w=n.position,l.matrix.copy(e)}}function F(n){if(s){var e=new r.E;e.fromArray(n.matrix),v=n.position,s.matrix.copy(e)}}function M(n,e,t){u.setViewport(t.x,t.y,t.width,t.height);var o=new r.E;o.fromArray(n,0),a.projectionMatrix.fromArray(e),a.matrixWorldInverse.copy(o),i.matrix.copy(o),i.updateMatrixWorld(!0),u.render(i,a),u.clearDepth()}function P(n){l=n}function j(n){s=n}function A(){return v}function L(){return w}function z(n,e,t,r){n&&e&&t&&r?(i=e,a=t,u=r,o=n.getContext("webgl",{xrCompatible:!0}),navigator.xr.requestSession("immersive-vr",{requiredFeatures:["local"]}).then(b).catch(function(n){window.requestAnimationFrame(H)})):console.error("Missing required parameter")}function k(n,e,t){c.push({hand:n,num:e,func:t})}function q(n,e,t){d.push({hand:n,num:e,func:t})}function O(n){f=n}function W(n,e){for(var t=c,r=0;r<t.length;r++){var o=t[r];o.hand===n&&o.num===e&&o.func()}}function E(n,e){for(var t=d,r=0;r<t.length;r++){var o=t[r];o.hand===n&&o.num===e&&o.func()}}},81:function(n,e,t){"use strict";t.r(e);t(50);var r=t(0),o=t(51),i=t(46),a=t.n(i),u=t(47),l=t(48),s=t.n(l),c=t(49),d=t.n(c);function f(n){return n*(Math.PI/180)}var p,h=null,g=null,m=null,v=null,w=null,y=null,b=null,x=null,H=null,R=[],S=0,B=null,F=null,M=!1,P=null,j=null;function A(n,e,t){var o=new r.F(new r.h(.35,.35,.35),new r.H({color:new r.g(16777215)})),i=(new r.hb).load(s.a),a=new r.F(new r.h(.5,.5,.5),new r.G({color:new r.g(16777215),map:i}));return o.position.x=n,o.position.y=e,o.position.z=t,a.position.x=n,a.position.y=e,a.position.z=t,h.add(o),h.add(a),o}x=document.createElement("canvas"),h=new r.ab,g=new r.Q(75,window.innerWidth/window.innerHeight,.1,1e3),m=new r.pb({canvas:x}),v=new r.j(16777215,1),w=new r.a(11184810),y=(new r.hb).load(d.a),b=new r.F(new r.fb(50,50,50),new r.G({map:y,side:r.k})),(H=new r.F(new r.R(10,10,10,10),new r.H({color:new r.g(16777215)}))).position.y=-1.5,H.position.z=0,H.rotateX(f(-90)),h.add(v),h.add(w),h.add(b),h.add(H),R.push(A(0,0,-4)),R.push(A(1.5,0,-5)),R.push(A(-1,1.5,-6)),R.push(A(1,1.5,-6)),R.push(A(-4,0,0)),R.push(A(-5,0,1.5)),R.push(A(-6,1.5,-1)),R.push(A(-6,1.5,1)),R.push(A(0,0,4)),R.push(A(1.5,0,5)),R.push(A(-1,1.5,6)),R.push(A(1,1.5,6)),R.push(A(4,0,0)),R.push(A(5,0,1.5)),R.push(A(6,1.5,-1)),R.push(A(6,1.5,1)),(new u.a).load(a.a,function(n){console.log(n),(p=n.scene.children[1]).material=new r.H({color:new r.g(12303291)}),p.material.side=r.k,p.traverse(function(n){n.material=new r.H({color:new r.g(6175774),skinning:!0})}),p.rotateX(f(90)),p.scale.x=.5,p.scale.y=.5,p.scale.z=.5,j=p.children[1].children[0].skeleton.bones[17],(B=new r.n).add(p),h.add(B),o.setLeftHand(B);var e=n.scene.children[1];e.material=new r.H({color:new r.g(6175774)}),e.scale.y=.1,e.scale.z=.1,e.scale.x=.1,e.rotateX(f(180)),e.position.z=-.25,(P=e.clone()).rotateX(f(-90)),P.position.y-=.23,P.position.z+=.25,(F=new r.n).add(e),h.add(F),o.setRightHand(F)},function(n){console.log("".concat(n.loaded/n.total*100,"% loaded"))},function(n){console.error("An error happened",n)}),o.addButtonPressListener("right",0,function(){console.log("right handle buttons squeezed"),M=!0}),o.addButtonReleaseListener("right",0,function(){M=!1,o.setRightHand(null),F.children[0].speed=S/2,j.position.y=-1.4162278175354004;var n=F.clone();h.add(n),F=n,o.setRightHand(F)}),o.setUpdate(function(){var n=o.getLeftHandPostion(),e=o.getRightHandPostion();if(n&&e){var t=new r.mb(n.x,n.y,n.z),i=new r.mb(e.x,e.y,e.z);S=t.distanceTo(i),j&&M&&(j.position.y=Math.min(-12*S,-1.4162278175354004))}for(var a=R.length,u=0;u<a;++u){var l=R[u];l.geometry.computeBoundingBox();var s=l.geometry.boundingBox.clone();l.updateMatrixWorld(!0),s.copy(l.geometry.boundingBox).applyMatrix4(l.matrixWorld),h.traverse(function(n){if(n.speed){n.position.z-=n.speed,n.geometry.computeBoundingBox();var e=n.geometry.boundingBox.clone();n.updateMatrixWorld(!0),e.copy(n.geometry.boundingBox).applyMatrix4(n.matrixWorld),e.intersectsBox(s)&&(console.log("intersection"),n.speed=0)}})}}),o.checkForXRSupport().then(function(n){document.getElementById("button-start").addEventListener("click",function(){o.start(x,h,g,m)})}).catch(function(n){console.error(n)})}});
//# sourceMappingURL=app.a8ade2fc.js.map